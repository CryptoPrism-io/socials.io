<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style_trading_calls_story.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <title>Trading Calls Story - {{ call_type }}</title>
</head>
<body>
    <div class="story-container">
        <!-- Header Branding -->
        <div class="story-header">
            <div class="brand-container">
                <div class="prism-triangle"></div>
                <span class="brand-text">CRYPTO PRISM</span>
            </div>
            <div class="story-timestamp">{{ current_time }}</div>
        </div>

        <!-- Hook Section -->
        <div class="hook-section">
            <div class="hook-icon">{% if call_type == 'LONG' %}ðŸš€{% else %}ðŸ“‰{% endif %}</div>
            <div class="hook-text">{{ call_type }} CALL POSITIONS</div>
            <div class="hook-subtitle">Top {% if call_type == 'LONG' %}Bullish{% else %}Bearish{% endif %} Trading Opportunities</div>
        </div>

        <!-- Top 3 Positions -->
        <div class="positions-section">
            {% for coin in top_positions[:3] %}
            <div class="position-card">
                <div class="position-header">
                    <div class="coin-info">
                        <img src="{{ coin.logo }}" alt="{{ coin.symbol }}" class="coin-logo">
                        <div class="coin-details">
                            <div class="coin-symbol">{{ coin.symbol }}</div>
                            <div class="coin-rank">#{{ coin.cmc_rank }}</div>
                        </div>
                    </div>
                    <div class="price-info">
                        <div class="coin-price">${{ coin.price }}</div>
                        <div class="pct-change {% if coin.percent_change24h|float >= 0 %}positive{% else %}negative{% endif %}">
                            {% if coin.percent_change24h|float >= 0 %}+{% endif %}{{ coin.percent_change24h }}%
                        </div>
                    </div>
                </div>

                <!-- DMV Scores -->
                <div class="dmv-scores">
                    <div class="dmv-item">
                        <div class="dmv-label">D</div>
                        <div class="dmv-value {% if coin.Durability_Score|float < 0 %}low{% elif coin.Durability_Score|float <= 50 %}medium{% else %}high{% endif %}">
                            {{ coin.Durability_Score|round(1) if coin.Durability_Score else 'N/A' }}
                        </div>
                    </div>
                    <div class="dmv-item">
                        <div class="dmv-label">M</div>
                        <div class="dmv-value {% if coin.Momentum_Score|float < 0 %}low{% elif coin.Momentum_Score|float <= 50 %}medium{% else %}high{% endif %}">
                            {{ coin.Momentum_Score|round(1) if coin.Momentum_Score else 'N/A' }}
                        </div>
                    </div>
                    <div class="dmv-item">
                        <div class="dmv-label">V</div>
                        <div class="dmv-value {% if coin.Valuation_Score|float < 0 %}low{% elif coin.Valuation_Score|float <= 50 %}medium{% else %}high{% endif %}">
                            {{ coin.Valuation_Score|round(1) if coin.Valuation_Score else 'N/A' }}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Stats Summary -->
        <div class="stats-summary">
            <div class="stat-box">
                <div class="stat-number">{{ total_positions }}</div>
                <div class="stat-label">Total Positions</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">{{ avg_dmv|round(1) }}</div>
                <div class="stat-label">Avg DMV Score</div>
            </div>
        </div>

        <!-- CTA Section -->
        <div class="cta-section">
            <div class="cta-card {{ call_type|lower }}">
                <div class="cta-text">SEE ALL {{ total_positions }} POSITIONS</div>
                <div class="cta-subtitle">Visit @cryptoprism.io to learn more</div>
            </div>
        </div>

        <!-- Footer -->
        <div class="story-footer">
            <div class="footer-brand">cryptoprism.io</div>
        </div>
    </div>
</body>
</html>
